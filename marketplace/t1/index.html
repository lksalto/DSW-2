<!DOCTYPE html>
<html class="">

<head>
    <meta charset='utf-8'>
    <title>Laboratório</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link href="tailwindOutput.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <script>
        let discosData = []; // Store the fetched discos data globally

        function loadDiscos() {
            fetch('discos.json')
                .then(response => response.json())
                .then(discos => {
                    discosData = discos; // Save the data globally
                    populateGenres(discosData); // Populate the genre dropdown
                    displayDiscos(discosData); // Display all discos initially
                });
        }

        function populateGenres(discos) {
            const genreFilter = document.getElementById('genreFilter');
            const genres = new Set();

            // Collect all unique genres from the data
            discos.forEach(disco => genres.add(disco.genre));

            // Add "All" option
            genreFilter.innerHTML = '<option value="all">All</option>';

            // Populate the dropdown with genres
            genres.forEach(genre => {
                const option = document.createElement('option');
                option.value = genre;
                option.textContent = genre.charAt(0).toUpperCase() + genre.slice(1); // Capitalize the first letter
                genreFilter.appendChild(option);
            });
        }

        function displayDiscos(discos) {
            const produtosContainer = document.getElementById('produtos-container');
            produtosContainer.innerHTML = ''; // Clear the container

            discos.forEach(disco => {
                const preco = parseFloat(disco.preco);

                const produtoElement = document.createElement('div');
                produtoElement.classList.add('bg-gray-100', 'dark:bg-gray-800', 'rounded-lg', 'shadow-lg', 'flex', 'flex-col', 'items-center', 'p-4');
                
                produtoElement.innerHTML = `
                    <img src="${disco.imagem}" alt="${disco.nome}" class="w-full h-40 object-cover rounded-t-lg">
                    <h3 class="mt-4 text-lg font-bold text-gray-800 dark:text-white">${disco.nome}</h3>
                    <p class="text-green-600 dark:text-green-400 font-semibold mt-2">R$ ${preco.toFixed(2)}</p>
                    <button onclick="addToCart()" class="mt-4 w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg">
                        Adicionar ao Carrinho
                    </button>
                `;

                produtosContainer.appendChild(produtoElement);
            });
        }

        function filterDiscos() {
            const genreFilter = document.getElementById('genreFilter').value;
            const filteredDiscos = genreFilter === 'all'
                ? discosData // Show all discos if "all" is selected
                : discosData.filter(disco => disco.genre === genreFilter);
            displayDiscos(filteredDiscos); // Update the display
        }

        window.onload = () => {
            loadDiscos();
            document.getElementById('genreFilter').addEventListener('change', filterDiscos);
        };

    </script>
</head>

<body class="w-full flex flex-col font-mono bg-white dark:bg-black dark:text-white">
    <div class="fixed top-0 left-0 w-full h-14 p-4 flex flex-row justify-between
    bg-red-800 border-b border-b-gray-300 dark:bg-gray-900
    dark:border-b-gray-800 z-10">
        <div class="flex flex-row items-center gap-x-4 ">
            <div onclick="toggleMenu()" class="flex items-center justify-center
            select-none cursor-pointer text-gray-500 hover:text-orange-800
            active:text-red-500 dark:hover:text-orange-300
            dark:active:text-red-500">
                <i class="material-icons">menu</i>
            </div>

            <div class="font-bold text-2xl cursor-pointer
            select-none">Toca Do Disco</div>
            <div id="menu" class="fixed top-14 left-0 w-full z-10 hidden
            flex-col p-8 gap-y-2 text-lg font-bold bg-gray-200
            dark:bg-gray-900">
                <div class="p-2 cursor-pointer select-none hover:text-orange-800
                dark:hover:text-orange-300">Página Inicial</div>
                <div class="p-2 cursor-pointer select-none hover:text-orange-800
                dark:hover:text-orange-300">Login</div>
                <div class="p-2 cursor-pointer select-none hover:text-orange-800
                dark:hover:text-orange-300">Cadastro</div>
            </div>
        </div>
        <div class="flex flex-row gap-x-2">
            <div class="flex items-center cursor-pointer select-none text-black hover:text-yellow-500 dark:text-white">
                <i class="material-icons">shopping_cart</i>
                <span id="cart-count" class="ml-2 text-sm text-red-500">0</span>
            </div>

            <div onclick="toggleDarkMode()" class="select-none cursor-pointer
            text-black hover:text-yellow-500 dark:text-white">
                <div class="text-xs dark:hidden">
                    <i class="material-icons">nightlight</i>
                </div>
                <div class="text-xs hidden dark:block">
                    <i class="material-icons">lightbulb</i>
                </div>
            </div>
        </div>
    </div>

    <div class="flex-col w-full">
        <img src="images/banner.jpg" 
             alt="Descrição da Imagem" 
             class="w-full h-64 object-cover">
    </div>
    <div class="w-full p-4 flex justify-center items-center gap-4 bg-indigo-300 dark:bg-gray-800">
        <label for="genreFilter" class="text-indigo-800 dark:text-yellow-300">Filter by Genre:</label>
        <select id="genreFilter" class="rounded p-2 bg-white dark:bg-gray-700 text-indigo-900 dark:text-yellow-200">
            <!-- Options will be added programmatically -->
        </select>
    </div>
    <div class="flex-col p-8">
        <div id="produtos-container" class="grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        </div>
    </div>
</body>

</html>
